<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
  	<title>sheetsee.js | example</title>
		
		<link rel="profile" href="http://gmpg.org/xfn/11">
		<link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic,700italic'  type='text/css'>
		<link rel="stylesheet" href="css/normalize.css" type="text/css">
		<link rel="stylesheet" href="css/style.css" type="text/css">
		<link rel="stylesheet" href="leaflet.css" type="text/css">
		<script type="text/javascript" src="js/sheetsee.js"></script>
		<script type="text/javascript" src="js/tabletop.js"></script>
		<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script> 
		<script type="text/javascript" src="js/ICanHaz.js"></script> 
		<script type="text/javascript" src="js/d3.v2.js"></script> 
		<script type="text/javascript" src="js/accounting.js" ></script>
		<script type="text/javascript" src="js/leaflet.js"></script>
		<script type="text/javascript" src="js/modernizr.custom.33965.js"></script>		
</head>

<body>   
	<div id="pagewrapper">
		<div id="header">
			<p class="top-menu"><a href="#">HOME</a> / <a href="#">ABOUT THIS SITE</a> / <a href="#">CONTACT</a> / <a href="#">NEWS</a> </p> 
			<div id="title_container">
				<h1 class="tright">SHEETSEE.JS</h1>
				<p class="subtitle">Fill up Websites with Stuff from Spreasheets!</p>
			</div>
		</div><!-- #header END -->

	<div id="bread_box">
		<div id="breadcrumbs">
			<div class="left"><p>Economic Development</p></div>
			<div class="right"><p>Centreplex</p></div>
		</div><!-- #breadcrumbs END -->
	</div><!-- #bread_box END -->
     
	<div id="sidebar">
		<div class="button"><a href="#">SPLOST Overview</a></div>
			<div style="clear:both;"></div>
		<h5>SPLOST CATEGORIES & PROJECTS</h5>
			<div class="menu">
				<ul class="menu_cat">
					<li class="category ps"><a href="#">Public Safety Overview</a></li>
				</ul>
					<ul>
						<li class="ps first"><a href="#">Storm Drainage</a></li>
						<li class="ps second"><a href="#">Street Maintenance</a></li>
						<li class="ps first"><a href="#">GMA Lease Pool</a></li>
						<li class="ps second"><a href="#">Public Safety Equipment</a></li>
						<li class="ps first"><a href="#">Public Safety Other</a></li>
					</ul>
					</div><!-- #menu END -->
			<div class="menu">
				<ul class="menu_cat">
					<li class="category dr"><a href="#">Debt Retirement Overview</a></li>
				</ul>
					<ul>
						<li class="dr first"><a href="#">Debt Retirement</a></li>
						<li class="dr second"><a href="#">Bond Repayment</a></li>
					</ul>
			</div><!-- #menu END -->
			<div class="menu">
				<ul class="menu_cat">
					<li class="category ed"><a href="#">Economic Development Overview</a></li>
				</ul>
					<ul>
						<li class="ed first"><a href="#">Centreplex</a></li>
						<li class="ed second"><a href="#">Downtown Corridor</a></li>
					</ul>
			</div><!-- #menu END -->
			<div class="menu">
				<ul class="menu_cat">
					<li class="category ra"><a href="#">Rec & Cultural ArtsOverview</a></li>
				</ul>
				<ul>
					<li class="ra first"><a href="#">Tubman Museum</a></li>
					<li class="ra second"><a href="#">Bowden Golf</a></li>
					<li class="ra first"><a href="#">Rose Hill Cemetery</a></li>
					<li class="ra second"><a href="#">Ft. Hawkins</a></li>
				</ul>
			</div><!-- #menu END -->
	</div><!-- #sidebar END -->  
       
  <div id="maincontainer" class="overview" >
  	<h3>Sheetsee.js Example</h3>
			<p class="intro">This is a sample page to illustrate using a Google spreadsheet and tabletop.js to fill tables, templates, maps, charts... Everything below this text is generated from <a href="https://docs.google.com/a/codeforamerica.org/spreadsheet/ccc?key=0Aj3c4mZCQQaMdGE2TVphOWlXMUMyclRXa2Z1c0g5MGc" target="_blank">this Google spreadsheet</a>. The github repo is <a href="https://github.com/jllord/sheetsee.js" target="_blank">here</a>.</p>
      <p class="intro">This page mimics a real page which is part of a larger project of mine at <a href="http://www.codeforamerica.org">Code for America</a>. The project is <a href="http://www.seepennywork.in" target="_blank">See Penny Work</a>, you can see the example in action for the city of Macon <a href="http://splost.herokuapp.com" target="_blank">here</a>.</p>
			<p><small>Since this is a sample page, the sidebar and top menu links are just for show, they don't need to be goin' nowhere. The important stuff is below.</small></p>
	  <div class="articleHolder">
	    <h3>Location & Quick Stats</h3>
	      <div id="stats" ></div><!-- holds spot for stats -->
	      <div id="map" class="fullmap"><img class="spinner" src="images/fbi_spinner.gif"></div><!-- holds spot for map -->
	      <div class="clear"></div>
	  </div><!-- end holder -->

	  <div class="articleHolder">
	    <h3>Category Funding Comparison</h3>
	      <p>Below, a funds comparison between the Foucs Areas in Economic Development.</p>
	      <div id="holder"></div><!-- holds spot for bar chart -->
	  </div><!-- end holder -->

	  <div class="articleHolder">
	    <h3>Funding Schedule</h3>
	      <p>The projected dispersal of funds for Centreplex.</p>
	      <div id="table"></div><!-- holds spot for funding schedule -->
	  </div><!-- end holder -->

	  <div class="articleHolder">
	    <div id="monthly"><!-- holds spot for monthly expenditures - only if focus area has any -->
	      <h3>Monthly Expenditure Report</h3>
	      <p>Nothing yet to report in Centreplex.</p>
	    </div>
	  </div><!-- end holder -->
						
	  <div id="sharing">
	    <p>Share this page: </p>
	    <a href="https://twitter.com/share" class="twitter-share-button" data-via="jllord" data-hashtags="MaconSPLOST">Tweet</a>
	    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];
	      if(!d.getElementById(id)){js=d.createElement(s);
	      js.id=id; js.src="//platform.twitter.com/widgets.js";
	      fjs.parentNode.insertBefore(js,fjs);}
	      }(document,"script","twitter-wjs");</script>
	    <g:plusone size="medium"></g:plusone>
	    <div class="fb-like" data-send="true" data-layout="button_count" data-width="100" data-show-faces="false"></div>
	  </div>   
	</div><!-- end #maincontainer -->
	 
	<div id="footer">
	  <div class="footerThird"><!-- one of the 3 columns in footer -->
	    <h4>Built by Code for America in partnership with Macon, Georgia.</h4>
			<p>See the real project and all its additional Wordpress functionality <a href="http://splost.herokuapp.com">here</a>.</p>
	  </div>
	  <div class="footerThird"><!-- one of the 3 columns in footer -->
	    <h4>Get the Code.</h4>
			<p>The entire project (a Wordpress theme that utilizes sheetsee.js) is on Github <a href="http://www.github.com/jllord/sheetsee.js">here</a> and the repo with just sheetsee.js is <a href="http://www.github.com/jllord/sheetsee.js">here</a>.</p>
	  </div>
	  <div class="footerThird"><!-- one of the 3 columns in footer -->
	    <h4>A picture of a cat!</h4>
			<img src="http://distilleryimage3.s3.amazonaws.com/8b937136367411e2ba2422000a1f9376_7.jpg" width="120" />
	  </div>
	</div><!-- #footer end -->
	</div><!-- #pagewrapper end -->
						        
<!-- commence setting up the charts for mustache.js -->
<script id="monthly" type="text/html">// format the project expenditure table
<h3>Monthly Expenditure Report</h3>
  <p>Each month we publish a report on our expenses and tax/bond revenue with active projects. 
    If this project is active, the chart below will be populated with expenses related to Centreplex.</p>
  <h6 class="fleft">Monthly Report for:</h6> 
  <p><span class="statHighlight">  {{reportmonth}} / {{reportyear}}</span></p>

  <table class="monthlytable">
  <thead>
  <tr class="tableheader">
  <th>FOCUS AREA</th><th>PROJECT</th><th>BUDGET</th><th>ACTUAL</th><th>STATUS</th>
  </tr>
  </thead>
  {{#rows}}
    <tr>
    <td>{{focusarea}}</td><td >{{project}}</td><td class="yrdolls">{{budget}}</td><td class="yrdolls total">{{ptdactual}}</td><td 						class-"tright">{{status}}</td></tr>
  {{/rows}}
  </table>
</script>
			
<script id="stats" type="text/html">// format stats
 <h5>Centreplex has <span class="statHighlight">{{numberItemizedProjects}}</span> projects, <span class="statHighlight">{{numberInProgress}}</span> of which labeled in progress and <span class="statHighlight">{{completeProjects}}</span> are complete.</h5>
</script>
  
<script id="schedule" type="text/html">// format funding dispersal schedule
  <table>
  <thead>
  <tr class="tableheader">
  <th>FOCUS AREA</th><th>TOTAL</th><th>2012</th><th>2013</th><th>2014</th><th>2015</th><th>2016</th><th>2017</th><th>2018</th><th>2019</th>
  </tr>
  </thead>
  {{#rows}}
    <tr><td class = "project">{{focusarea}}</td><td class="total">{{total}}</td><td class="yrdolls">{{year2012}}</td><td class="yrdolls">{{year2013}}</td><td class="yrdolls">{{year2014}}</td><td class="yrdolls">{{year2015}}</td><td class="yrdolls">{{year2016}}</td><td class="yrdolls">{{year2017}}</td><td class="yrdolls">{{year2018}}</td><td class="yrdolls">{{year2019}}</td></tr>
  {{/rows}}
  </table>
</script>
			
<script type="text/javascript"> // make all the good stuff!   
  document.addEventListener('DOMContentLoaded', function() { // IE6 doesn't do DOMContentLoaded
     loadSpreadsheet(showInfo)
   })    
	 
   function showInfo(data, tabletop) {
     window.tabletopData = tabletop   

		 L.Icon.Default.imagePath = "images/"
     accounting.settings.currency.precision = 0
     var pageParent = "Economic Development" // get Parent Page name which is Category
     var pageName = "Centreplex" // get Page name which is Focus Area
     var thePageParent = getType(data, pageParent) // Filter to array of Category
     var thePageName  = getProject(data, pageName) // Filte to object of Focus Area
 
     // make map 

     var map = loadMap()
     thePageName.forEach(function (thePageName){ // forEach doesn't exist in IE8 below, see alternate function in sheetsee
       displayAddress(map, thePageName)
     })

     var noProjsInCat = thePageParent.length 
     // if user's browswer doesn't support SVG, tell them
     if (Modernizr.svg) renderGraph(thePageParent, noProjsInCat, "#holder") 
       else sorrySVG("#holder") 
     function sorrySVG(divTown) {
       $(divTown).text("Sorry, to see the chart you'll need to update your browser. <a href='https://www.google.com/intl/en/chrome/browser/'>Google Chrome</a> is great.")
     }
    	// These define the tables  	
      // -- quick stats table
      var itemizedArea = getActualsArea(tabletop.sheets("actuals").all(), pageName)
      var completeProjects = getStatusCount(itemizedArea, "Complete")
      var inProgress = getInProgress(itemizedArea)
      var sumInProgress = inProgressSpent(itemizedArea)

      var stats = ich.stats({
        numberItemizedProjects: itemizedArea.length,
        numberInProgress: inProgress.length,
        sumInProgress: accounting.formatMoney(sumInProgress),
        currentDate: getCurrentYear(),
        completeProjects: completeProjects
      })

      // -- schedule table
      var schedule = ich.schedule({
        rows: turnCurrency(thePageName)
      }) 

      // -- monthly expense table
      var monthlyrev = getActualsArea(tabletop.sheets("actuals").all(), pageName)
      var reportmonth = getCurrentMonth() - 1
      var reportyear = getCurrentYear()
      var monthly = ich.monthly({
        rows: turnReportCurrency(monthlyrev),
        reportyear: reportyear,
        reportmonth: reportmonth
      })

     // write these objects to the page
     $('#stats').html(stats)
     $('#table').html(schedule)
     if (monthlyrev.length > 0) $('#monthly').html(monthly)
   }
</script>
<script type="text/javascript">
  //makes g+ button
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<div id="fb-root"></div>
<script>
  // makes facebook button
  (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>
</body>
</html>